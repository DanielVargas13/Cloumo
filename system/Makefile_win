objs_bootpack = bootpack.obj mouse.obj keyboard.obj int.obj descriptor.obj file.obj memory.obj browser.obj sound.obj queue.obj multitask.obj timer.obj datetime.obj graphic.obj tek.obj utf82kt.obj functions.obj

TOOLPATH = ../../z_tools/
INCLUDE = ../../z_tools/include/

make     = $(TOOLPATH)make.exe -r
bim2hrb  = $(TOOLPATH)bim2hrb.exe
cpp      = $(TOOLPATH)gcc.exe -I$(INCPATH) -Os -Wall -nostdlib -fno-builtin -fno-exceptions -Weffc++ -fno-rtti -B$(TOOLPATH) -mno-stack-arg-probe -c
obj2bim  = $(TOOLPATH)obj2bim.exe
nask     = $(TOOLPATH)nask.exe
rulefile = $(INCLUDE)os.rul

# ftHg®ì

default :
	$(make) os.sys
	$(make) ipl.bin

# t@C¶¬K¥

bootpack.bim : $(objs_bootpack) jpeg.obj bmp.obj Makefile
	$(obj2bim) @$(rulefile) $(objs_bootpack) jpeg.obj bmp.obj out:bootpack.bim map:bootpack.map stack:3136k

bootpack.hrb : bootpack.bim Makefile
	$(bim2hrb) bootpack.bim bootpack.hrb 0

os.sys : asmhead.bin bootpack.hrb Makefile
	copy /B asmhead.bin+bootpack.hrb os.sys

# êÊK¥

%.obj : %.cc Makefile
	$(cpp) $*.cc -o $*.obj

%.obj : %.nas Makefile
	$(nask) $*.nas $*.obj

%.bin : %.nas Makefile
	$(nask) $*.nas $*.bin

# R}h

clean :
	-del *.map
	-del *.bin
	-del $(objs_bootpack)
	-del *.bim
	-del *.hrb
	-del os.sys
